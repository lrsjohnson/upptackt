% -*- Mode:TeX -*-

%% IMPORTANT: The official thesis specifications are available at:
%%            http://libraries.mit.edu/archives/thesis-specs/
%%
%%            Please verify your thesis' formatting and copyright
%%            assignment before submission.  If you notice any
%%            discrepancies between these templates and the
%%            MIT Libraries' specs, please let us know
%%            by e-mailing thesis@mit.edu

%% The documentclass options along with the pagestyle can be used to generate
%% a technical report, a draft copy, or a regular thesis.  You may need to
%% re-specify the pagestyle after you \include  cover.tex.  For more
%% information, see the first few lines of mitthesis.cls.

%\documentclass[12pt,vi,twoside]{mitthesis}
%%
%%  If you want your thesis copyright to you instead of MIT, use the
%%  ``vi'' option, as above.
%%
%\documentclass[12pt,twoside,leftblank]{mitthesis}
%%
%% If you want blank pages before new chapters to be labelled ``This
%% Page Intentionally Left Blank'', use the ``leftblank'' option, as
%% above.

\documentclass[12pt,twoside,bibliography=totoc]{mitthesis}
\usepackage{lgrind}
%% These have been added at the request of the MIT Libraries, because
%% some PDF conversions mess up the ligatures.  -LB, 1/22/2014
\usepackage{cmap}
\usepackage[T1]{fontenc}
\pagestyle{plain}

\usepackage{graphicx}


%% Code Listings:

\usepackage{multicol}
\usepackage{pdflscape}

\usepackage{listings}

\usepackage[T1]{fontenc}
\usepackage[scaled=0.85]{beramono}
\usepackage{listings}
\usepackage{textcomp}
\usepackage{color}
\usepackage{caption}

\usepackage[nottoc,notlof,notlot,numbib]{tocbibind}

\usepackage[utf8]{inputenc}

\usepackage{tcolorbox}
\tcbuselibrary{most}


\lstdefinestyle{mystyle}{numbers=left,numberstyle=\tiny,numbersep=5pt,
  morekeywords=[1]{define, define-syntax, define-macro, lambda, define-stream, stream-lambda},
  morekeywords=[2]{begin, call-with-current-continuation, call/cc,
    call-with-input-file, call-with-output-file, case, cond,
    do, else, for-each, if,
    let*, let, let-syntax, letrec, letrec-syntax,
    let-values, let*-values,
    and, or, not, delay, force,
    quasiquote, quote, unquote, unquote-splicing,
    map, fold, syntax, syntax-rules, eval, environment, query,
    let-geo*, define-record-type,
 },
  morekeywords=[3]{import, export},
  alsodigit=!\$\%&*+-./:<=>?@^_~,
  sensitive=true,
  morecomment=[l]{;},
  morecomment=[s]{\#|}{|\#},
  morestring=[b]",
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bf\ttfamily,
  xleftmargin=0.1in,
  commentstyle=\color[rgb]{0.255,0.255,0.255},
  stringstyle={\color[rgb]{0.4,0.4,0.4}},
  upquote=true,
  breaklines=true,
  breakatwhitespace=true,
  literate=*{`}{{`}}{1},
  literate = {\%}{{{\%}}}2,
  showstringspaces=false,breaklines}

\lstset{style=mystyle}

%% Actual Code Listings:


\newtcblisting[auto counter,number within=chapter]{code-example}[2][]{
listing only, breakable,
code=\linespread{1}\vspace{1em},
listing options={style=mystyle, basicstyle=\footnotesize\ttfamily},
fonttitle=\bfseries,
title=Code Example \thetcbcounter: #2,#1}

\newtcblisting[use counter from=code-example]{repl-example}[2][]{
listing only, breakable,
code=\linespread{1}\vspace{1em},
listing options={style=mystyle, basicstyle=\footnotesize\ttfamily,
numbers=none},
fonttitle=\bfseries,
title=Interaction Example \thetcbcounter: #2,#1}

\newtcblisting[use counter from=code-example]{code-listing}[2][]{
listing only, breakable,
code=\linespread{1}\vspace{1em},
listing options={style=mystyle, basicstyle=\footnotesize\ttfamily},
fonttitle=\bfseries,
title=Code Listing \thetcbcounter: #2,#1}

\newtcblisting[use counter from=code-example]{img-example}[3][]{
listing and comment, righthand width=5cm,
code=\linespread{1}\vspace{1em},
listing options={style=mystyle,numbers=none,
basicstyle=\footnotesize\ttfamily},
tcbimage comment={#3},
fonttitle=\bfseries,
comment style={size=fbox,frame hidden,height=6cm},
%every listing line*={\textcolor{black}{\small\ttfamily\bfseries => }},
title=Interaction Example \thetcbcounter: #2,#1
}

\newtcblisting[use counter from=code-example]{pdf-example}[3][]{
listing and comment, righthand width=5cm, breakable,
code=\linespread{1}\vspace{1em},
listing options={style=mystyle,numbers=none,
basicstyle=\footnotesize\ttfamily},
pdf comment={#3},
fonttitle=\bfseries,
comment style={frame hidden,
opacityback=0,
height=6cm,
raster columns=2,graphics pages={1,2}},
%every listing line*={\textcolor{black}{\small\ttfamily\bfseries => }},
title=Interaction Example \thetcbcounter: #2,#1
}



%% End Code Listings

%% This bit allows you to either specify only the files which you wish to
%% process, or `all' to process all files which you \include.
%% Krishna Sethuraman (1990).

\typein [\files]{Enter file names to process, (chap1,chap2 ...), or `all' to
 process all files:}
\def\all{all}
\ifx\files\all \typeout{Including all files.} \else \typeout{Including only \files.} \includeonly{\files} \fi

\begin{document}

\include{cover}
% Some departments (e.g. 5) require an additional signature page.  See
% signature.tex for more information and uncomment the following line if
% applicable.
% \include{signature}
\pagestyle{plain}
\include{contents}
\include{chap-intro}
\include{chap-motivation}
\include{chap-demo}
\include{chap-sys-overview}
\include{chap-imperative}
\include{chap-observation}
\include{chap-declarative}
\include{chap-learning}
\include{chap-related}
%\include{chap-results}
\include{chap-conclusion}
\appendix
\include{appa}
%\include{appb}
\include{biblio}
\end{document}
